<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>unnest — unnest • tidySummarizedExperiment</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="unnest — unnest"><meta property="og:description" content="Given a regular expression with capturing groups, extract() turns
each group into a new column. If the groups don't match, or the input
is NA, the output will be NA.
pivot_longer() &quot;lengthens&quot; data, increasing the number of rows and
decreasing the number of columns. The inverse transformation is
pivot_wider()
Learn more in vignette(&quot;pivot&quot;).
pivot_wider() &quot;widens&quot; data, increasing the number of columns and
decreasing the number of rows. The inverse transformation is
pivot_longer().
Learn more in vignette(&quot;pivot&quot;).
Convenience function to paste together multiple columns into one.
Given either a regular expression or a vector of character positions,
separate() turns a single character column into multiple columns."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidySummarizedExperiment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Overview of the tidySummarizedExperiment package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stemangiola/tidySummarizedExperiment/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>unnest</h1>
    <small class="dont-index">Source: <a href="https://github.com/stemangiola/tidySummarizedExperiment/blob/HEAD/R/tidyr_methods.R" class="external-link"><code>R/tidyr_methods.R</code></a></small>
    <div class="hidden name"><code>tidyr-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a regular expression with capturing groups, <code>extract()</code> turns
each group into a new column. If the groups don't match, or the input
is NA, the output will be NA.</p>
<p><code>pivot_longer()</code> "lengthens" data, increasing the number of rows and
decreasing the number of columns. The inverse transformation is
<code>pivot_wider()</code></p>
<p>Learn more in <code>vignette("pivot")</code>.</p>
<p><code>pivot_wider()</code> "widens" data, increasing the number of columns and
decreasing the number of rows. The inverse transformation is
<code>pivot_longer()</code>.</p>
<p>Learn more in <code>vignette("pivot")</code>.</p>
<p>Convenience function to paste together multiple columns into one.</p>
<p>Given either a regular expression or a vector of character positions,
<code>separate()</code> turns a single character column into multiple columns.</p>
    </div>


    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>keep_empty</dt>
<dd><p>See tidyr::unnest</p></dd>


<dt>ptype</dt>
<dd><p>See tidyr::unnest</p></dd>


<dt>.drop</dt>
<dd><p>See tidyr::unnest</p></dd>


<dt>.id</dt>
<dd><p>tidyr::unnest</p></dd>


<dt>.sep</dt>
<dd><p>tidyr::unnest</p></dd>


<dt>.preserve</dt>
<dd><p>See tidyr::unnest</p></dd>


<dt>.data</dt>
<dd><p>A tbl. (See tidyr)</p></dd>


<dt>.names_sep</dt>
<dd><p>See ?tidyr::nest</p></dd>


<dt>into</dt>
<dd><p>Names of new variables to create as character vector.
Use <code>NA</code> to omit the variable in the output.</p></dd>


<dt>regex</dt>
<dd><p>a regular expression used to extract the desired values.
There should be one group (defined by <code>()</code>) for each element of <code>into</code>.</p></dd>


<dt>convert</dt>
<dd><p>If <code>TRUE</code>, will run <code><a href="https://rdrr.io/r/utils/type.convert.html" class="external-link">type.convert()</a></code> with
<code>as.is=TRUE</code> on new columns. This is useful if the component
columns are integer, numeric or logical.</p>
<p>NB: this will cause string <code>"NA"</code>s to be converted to <code>NA</code>s.</p></dd>


<dt>cols</dt>
<dd><p>&lt;<code>tidy-select</code>&gt; Columns to pivot into
longer format.</p></dd>


<dt>cols_vary</dt>
<dd><p>When pivoting <code>cols</code> into longer format, how should the
output rows be arranged relative to their original row number?</p><ul><li><p><code>"fastest"</code>, the default, keeps individual rows from <code>cols</code> close
together in the output. This often produces intuitively ordered output
when you have at least one key column from <code>data</code> that is not involved in
the pivoting process.</p></li>
<li><p><code>"slowest"</code> keeps individual columns from <code>cols</code> close together in the
output. This often produces intuitively ordered output when you utilize
all of the columns from <code>data</code> in the pivoting process.</p></li>
</ul></dd>


<dt>names_to</dt>
<dd><p>A character vector specifying the new column or columns to
create from the information stored in the column names of <code>data</code> specified
by <code>cols</code>.</p><ul><li><p>If length 0, or if <code>NULL</code> is supplied, no columns will be created.</p></li>
<li><p>If length 1, a single column will be created which will contain the
column names specified by <code>cols</code>.</p></li>
<li><p>If length &gt;1, multiple columns will be created. In this case, one of
<code>names_sep</code> or <code>names_pattern</code> must be supplied to specify how the
column names should be split. There are also two additional character
values you can take advantage of:</p><ul><li><p><code>NA</code> will discard the corresponding component of the column name.</p></li>
<li><p><code>".value"</code> indicates that the corresponding component of the column
name defines the name of the output column containing the cell values,
overriding <code>values_to</code> entirely.</p></li>
</ul></li>
</ul></dd>


<dt>names_sep, names_pattern</dt>
<dd><p>If <code>names_to</code> contains multiple values,
these arguments control how the column name is broken up.</p>
<p><code>names_sep</code> takes the same specification as <code>separate()</code>, and can either
be a numeric vector (specifying positions to break on), or a single string
(specifying a regular expression to split on).</p>
<p><code>names_pattern</code> takes the same specification as <code>extract()</code>, a regular
expression containing matching groups (<code>()</code>).</p>
<p>If these arguments do not give you enough control, use
<code>pivot_longer_spec()</code> to create a spec object and process manually as
needed.</p></dd>


<dt>names_repair</dt>
<dd><p>What happens if the output has invalid column names?
The default, <code>"check_unique"</code> is to error if the columns are duplicated.
Use <code>"minimal"</code> to allow duplicates in the output, or <code>"unique"</code> to
de-duplicated by adding numeric suffixes. See <code><a href="https://vctrs.r-lib.org/reference/vec_as_names.html" class="external-link">vctrs::vec_as_names()</a></code>
for more options.</p></dd>


<dt>values_to</dt>
<dd><p>A string specifying the name of the column to create
from the data stored in cell values. If <code>names_to</code> is a character
containing the special <code>.value</code> sentinel, this value will be ignored,
and the name of the value column will be derived from part of the
existing column names.</p></dd>


<dt>values_drop_na</dt>
<dd><p>If <code>TRUE</code>, will drop rows that contain only <code>NA</code>s
in the <code>value_to</code> column. This effectively converts explicit missing values
to implicit missing values, and should generally be used only when missing
values in <code>data</code> were created by its structure.</p></dd>


<dt>names_transform, values_transform</dt>
<dd><p>Optionally, a list of column
name-function pairs. Alternatively, a single function can be supplied,
which will be applied to all columns. Use these arguments if you need to
change the types of specific columns. For example, <code>names_transform = list(week = as.integer)</code> would convert a character variable called <code>week</code>
to an integer.</p>
<p>If not specified, the type of the columns generated from <code>names_to</code> will
be character, and the type of the variables generated from <code>values_to</code>
will be the common type of the input columns used to generate them.</p></dd>


<dt>names_ptypes, values_ptypes</dt>
<dd><p>Optionally, a list of column name-prototype
pairs. Alternatively, a single empty prototype can be supplied, which will
be applied to all columns. A prototype (or ptype for short) is a
zero-length vector (like <code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>) that defines the type,
class, and attributes of a vector. Use these arguments if you want to
confirm that the created columns are the types that you expect. Note that
if you want to change (instead of confirm) the types of specific columns,
you should use <code>names_transform</code> or <code>values_transform</code> instead.</p></dd>


<dt>id_cols</dt>
<dd><p>&lt;<code>tidy-select</code>&gt; A set of columns that
uniquely identify each observation. Typically used when you have
redundant variables, i.e. variables whose values are perfectly correlated
with existing variables.</p>
<p>Defaults to all columns in <code>data</code> except for the columns specified through
<code>names_from</code> and <code>values_from</code>. If a tidyselect expression is supplied, it
will be evaluated on <code>data</code> after removing the columns specified through
<code>names_from</code> and <code>values_from</code>.</p></dd>


<dt>id_expand</dt>
<dd><p>Should the values in the <code>id_cols</code> columns be expanded by
<code>expand()</code> before pivoting? This results in more rows, the output will
contain a complete expansion of all possible values in <code>id_cols</code>. Implicit
factor levels that aren't represented in the data will become explicit.
Additionally, the row values corresponding to the expanded <code>id_cols</code> will
be sorted.</p></dd>


<dt>names_from, values_from</dt>
<dd><p>&lt;<code>tidy-select</code>&gt; A pair of
arguments describing which column (or columns) to get the name of the
output column (<code>names_from</code>), and which column (or columns) to get the
cell values from (<code>values_from</code>).</p>
<p>If <code>values_from</code> contains multiple values, the value will be added to the
front of the output column.</p></dd>


<dt>names_sep</dt>
<dd><p>If <code>names_from</code> or <code>values_from</code> contains multiple
variables, this will be used to join their values together into a single
string to use as a column name.</p></dd>


<dt>names_prefix</dt>
<dd><p>String added to the start of every variable name. This is
particularly useful if <code>names_from</code> is a numeric vector and you want to
create syntactic variable names.</p></dd>


<dt>names_glue</dt>
<dd><p>Instead of <code>names_sep</code> and <code>names_prefix</code>, you can supply
a glue specification that uses the <code>names_from</code> columns (and special
<code>.value</code>) to create custom column names.</p></dd>


<dt>names_sort</dt>
<dd><p>Should the column names be sorted? If <code>FALSE</code>, the default,
column names are ordered by first appearance.</p></dd>


<dt>names_vary</dt>
<dd><p>When <code>names_from</code> identifies a column (or columns) with
multiple unique values, and multiple <code>values_from</code> columns are provided,
in what order should the resulting column names be combined?</p><ul><li><p><code>"fastest"</code> varies <code>names_from</code> values fastest, resulting in a column
naming scheme of the form: <code>value1_name1, value1_name2, value2_name1, value2_name2</code>. This is the default.</p></li>
<li><p><code>"slowest"</code> varies <code>names_from</code> values slowest, resulting in a column
naming scheme of the form: <code>value1_name1, value2_name1, value1_name2, value2_name2</code>.</p></li>
</ul></dd>


<dt>names_expand</dt>
<dd><p>Should the values in the <code>names_from</code> columns be expanded
by <code>expand()</code> before pivoting? This results in more columns, the output
will contain column names corresponding to a complete expansion of all
possible values in <code>names_from</code>. Implicit factor levels that aren't
represented in the data will become explicit. Additionally, the column
names will be sorted, identical to what <code>names_sort</code> would produce.</p></dd>


<dt>values_fill</dt>
<dd><p>Optionally, a (scalar) value that specifies what each
<code>value</code> should be filled in with when missing.</p>
<p>This can be a named list if you want to apply different fill values to
different value columns.</p></dd>


<dt>values_fn</dt>
<dd><p>Optionally, a function applied to the value in each cell
in the output. You will typically use this when the combination of
<code>id_cols</code> and <code>names_from</code> columns does not uniquely identify an
observation.</p>
<p>This can be a named list if you want to apply different aggregations
to different <code>values_from</code> columns.</p></dd>


<dt>unused_fn</dt>
<dd><p>Optionally, a function applied to summarize the values from
the unused columns (i.e. columns not identified by <code>id_cols</code>,
<code>names_from</code>, or <code>values_from</code>).</p>
<p>The default drops all unused columns from the result.</p>
<p>This can be a named list if you want to apply different aggregations
to different unused columns.</p>
<p><code>id_cols</code> must be supplied for <code>unused_fn</code> to be useful, since otherwise
all unspecified columns will be considered <code>id_cols</code>.</p>
<p>This is similar to grouping by the <code>id_cols</code> then summarizing the
unused columns using <code>unused_fn</code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame.</p></dd>


<dt>col</dt>
<dd><p>The name of the new column, as a string or symbol.</p>
<p>This argument is passed by expression and supports
<a href="https://rlang.r-lib.org/reference/topic-inject.html" class="external-link">quasiquotation</a> (you can unquote strings
and symbols). The name is captured from the expression with
<code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">rlang::ensym()</a></code> (note that this kind of interface where
symbols do not represent actual objects is now discouraged in the
tidyverse; we support it here for backward compatibility).</p></dd>


<dt>...</dt>
<dd><p>&lt;<code>tidy-select</code>&gt; Columns to unite</p></dd>


<dt>na.rm</dt>
<dd><p>If <code>TRUE</code>, missing values will be remove prior to uniting
each value.</p></dd>


<dt>remove</dt>
<dd><p>If <code>TRUE</code>, remove input columns from output data frame.</p></dd>


<dt>sep</dt>
<dd><p>Separator between columns.</p>
<p>If character, <code>sep</code> is interpreted as a regular expression. The default
value is a regular expression that matches any sequence of
non-alphanumeric values.</p>
<p>If numeric, <code>sep</code> is interpreted as character positions to split at. Positive
values start at 1 at the far-left of the string; negative value start at -1 at
the far-right of the string. The length of <code>sep</code> should be one less than
<code>into</code>.</p></dd>


<dt>extra</dt>
<dd><p>If <code>sep</code> is a character vector, this controls what
happens when there are too many pieces. There are three valid options:</p><ul><li><p>"warn" (the default): emit a warning and drop extra values.</p></li>
<li><p>"drop": drop any extra values without a warning.</p></li>
<li><p>"merge": only splits at most <code>length(into)</code> times</p></li>
</ul></dd>


<dt>fill</dt>
<dd><p>If <code>sep</code> is a character vector, this controls what
happens when there are not enough pieces. There are three valid options:</p><ul><li><p>"warn" (the default): emit a warning and fill from the right</p></li>
<li><p>"right": fill with missing values on the right</p></li>
<li><p>"left": fill with missing values on the left</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A tidySummarizedExperiment objector a tibble depending on input</p>


<p>A tidySummarizedExperiment objector a tibble depending on input</p>


<p>A tidySummarizedExperiment objector a tibble depending on input</p>


<p>A tidySummarizedExperiment objector a tibble depending on input</p>


<p>A tidySummarizedExperiment objector a tibble depending on input</p>


<p>A tidySummarizedExperiment objector a tibble depending on input</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>pivot_longer()</code> is an updated approach to <code>gather()</code>, designed to be both
simpler to use and to handle more use cases. We recommend you use
<code>pivot_longer()</code> for new code; <code>gather()</code> isn't going away but is no longer
under active development.</p>
<p><code>pivot_wider()</code> is an updated approach to <code>spread()</code>, designed to be both
simpler to use and to handle more use cases. We recommend you use
<code>pivot_wider()</code> for new code; <code>spread()</code> isn't going away but is no longer
under active development.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>separate()</code> to split up by a separator.</p>
<p><code>pivot_wider_spec()</code> to pivot "by hand" with a data frame that
defines a pivotting specification.</p>
<p><code>separate()</code>, the complement.</p>
<p><code>unite()</code>, the complement, <code>extract()</code> which uses regular
expression capturing groups.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">nest</span><span class="op">(</span>data<span class="op">=</span><span class="op">-</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">unnest</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A SummarizedExperiment-tibble abstraction: 102,193 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># </span><span style="color: #555555;">Features=14599 | Samples=7 | Assays=counts</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .feature    .sample counts type       condition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FBgn0000003 untrt1       0 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FBgn0000008 untrt1      92 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FBgn0000014 untrt1       5 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FBgn0000015 untrt1       0 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FBgn0000017 untrt1    <span style="text-decoration: underline;">4</span>664 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FBgn0000018 untrt1     583 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FBgn0000022 untrt1       0 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FBgn0000024 untrt1      10 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FBgn0000028 untrt1       0 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FBgn0000032 untrt1    <span style="text-decoration: underline;">1</span>446 single_end untreated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">nest</span><span class="op">(</span>data<span class="op">=</span><span class="op">-</span><span class="va">condition</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   condition data          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> untreated <span style="color: #949494;">&lt;SmmrzdEx[,4]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> treated   <span style="color: #949494;">&lt;SmmrzdEx[,3]&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">extract</span><span class="op">(</span><span class="va">type</span>, into<span class="op">=</span><span class="st">"sequencing"</span>, regex<span class="op">=</span><span class="st">"([a-z]*)_end"</span>, convert<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.vector(x, mode):</span> cannot coerce type 'closure' to vector of type 'any'</span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="co"># See vignette("pivot") for examples and explanation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">type</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"name"</span>, values_to<span class="op">=</span><span class="st">"value"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tidySummarizedExperiment says: A data frame is returned for independent data analysis.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 204,386 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .feature    .sample counts name      value     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FBgn0000003 untrt1       0 condition untreated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FBgn0000003 untrt1       0 type      single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FBgn0000008 untrt1      92 condition untreated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FBgn0000008 untrt1      92 type      single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FBgn0000014 untrt1       5 condition untreated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FBgn0000014 untrt1       5 type      single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FBgn0000015 untrt1       0 condition untreated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FBgn0000015 untrt1       0 type      single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FBgn0000017 untrt1    <span style="text-decoration: underline;">4</span>664 condition untreated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FBgn0000017 untrt1    <span style="text-decoration: underline;">4</span>664 type      single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 204,376 more rows</span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="co"># See vignette("pivot") for examples and explanation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">pivot_wider</span><span class="op">(</span>names_from<span class="op">=</span><span class="va">feature</span>, values_from<span class="op">=</span><span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tidySummarizedExperiment says: A data frame is returned for independent data analysis.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tidySummarizedExperiment says: from version 1.3.1, the special columns including sample/feature id (colnames(se), rownames(se)) has changed to ".sample" and ".feature". This dataset is returned with the old-style vocabulary (feature and sample), however we suggest to update your workflow to reflect the new vocabulary (.feature, .sample)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 14,602</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample condition type       FBgn0000003 FBgn0000008 FBgn0000014 FBgn0000015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> untrt1 untreated single_end           0          92           5           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> untrt2 untreated single_end           0         161           1           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> untrt3 untreated paired_end           0          76           0           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> untrt4 untreated paired_end           0          70           0           2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> trt1   treated   single_end           0         140           4           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> trt2   treated   paired_end           0          88           0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> trt3   treated   paired_end           1          70           0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 14,595 more variables: FBgn0000017 &lt;int&gt;, FBgn0000018 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000022 &lt;int&gt;, FBgn0000024 &lt;int&gt;, FBgn0000028 &lt;int&gt;, FBgn0000032 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000036 &lt;int&gt;, FBgn0000037 &lt;int&gt;, FBgn0000038 &lt;int&gt;, FBgn0000039 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000042 &lt;int&gt;, FBgn0000043 &lt;int&gt;, FBgn0000044 &lt;int&gt;, FBgn0000045 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000046 &lt;int&gt;, FBgn0000047 &lt;int&gt;, FBgn0000052 &lt;int&gt;, FBgn0000053 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000054 &lt;int&gt;, FBgn0000055 &lt;int&gt;, FBgn0000056 &lt;int&gt;, FBgn0000057 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   FBgn0000061 &lt;int&gt;, FBgn0000063 &lt;int&gt;, FBgn0000064 &lt;int&gt;, …</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">tidySummarizedExperiment</span><span class="fu">::</span><span class="va"><a href="pasilla.html">pasilla</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu">unite</span><span class="op">(</span><span class="st">"group"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">type</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tidySummarizedExperiment says: Key columns are missing. A data frame is returned for independent data analysis.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A SummarizedExperiment-tibble abstraction: 102,193 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># </span><span style="color: #555555;">Features=14599 | Samples=7 | Assays=counts</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    .feature    .sample counts group               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> FBgn0000003 untrt1       0 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> FBgn0000008 untrt1      92 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> FBgn0000014 untrt1       5 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> FBgn0000015 untrt1       0 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> FBgn0000017 untrt1    <span style="text-decoration: underline;">4</span>664 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> FBgn0000018 untrt1     583 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> FBgn0000022 untrt1       0 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> FBgn0000024 untrt1      10 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> FBgn0000028 untrt1       0 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> FBgn0000032 untrt1    <span style="text-decoration: underline;">1</span>446 untreated_single_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 40 more rows</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano Mangiola.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

